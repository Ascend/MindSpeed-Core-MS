# 激活函数重计算

## 问题分析

大模型训练过程中，会面临显存不足的问题

## 解决方案

本特性支持了Norm的重计算

## 解决思路

运用激活函数重计算的 `checkpoint` 机制，对norm计算进行处理

## 使用场景

主要用于训练场景，用户内存不足或要节省内存时

## 使用方法

脚本中添加：`--recompute-norm` 可开启Norm重计算

添加：`--recompute-norm-num-layers ${num}` 可指定激活函数重计算的层数

Norm重计算兼容激活函数重计算全重计算同时开启：

1.同时开启时，仅支持 `--recompute-method 为 block`

2.同时开启时，会按照指定的全重计算和Norm重计算的层数做各自类型的重计算，即不会有一层既做全重计算又做Norm重计算。

（注意点：执行优先级是先计算全重计算层，后Norm重计算层。）

